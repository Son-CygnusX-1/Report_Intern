
## Tạo máy ảo


1. [Virt-manager](#virt-manager)
2. [Virt-install](#virt-install)
3. [Webvirt](#webvirt)

<a name="virt-manager"></a>
### 1. Tạo máy ảo bằng virt-manager

Cài đặt virt-manager

	apt-get install virt-manage

Mặc định, các file ISO sẽ được lưu ở trong thư mục `/var/lib/libvirt/images/`

Tải một image nhẹ để test tạo máy ảo

	cd /var/lib/libvirt/images/
	wget http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img

Kích hoạt virt-manager

	virt-manager

Nếu sử dụng MobaXterm để ssh tới thì mặc định đã hỗ trợ forward X11, nếu sử dụng các công cụ khác cần kích hoạt chế độ này thì mới có thể sử dụng virt-manager.

Sau khi câu lệnh trên được thực hiện sẽ hiện ra giao diện của virt-manager

<img src="img/4.png">

Chọn `new` để tạo máy ảo mới, Chọn cách để cài máy ảo

* `Local install media` nếu muốn cài từ file iso
* `Import existing disk image` nếu bạn muốn cài từ file image
* Còn lại là lựa chọn cài từ mạng ngoài

<img src="img/5.png">

Ở đây, tôi chọn kiểu cài file ISO, chọn `Browse` để tìm các file ISO có sẵn trên máy (bên trên đã tải về)

<img src="img/7.png">

Chọn RAM và CPU 

<img src="img/8.png">

Chọn dung lượng ổ đĩa

<img src="img/9.png">

Đặt tên cho máy ảo và tùy chọn `Customize configuration before install` nếu muốn xem lại hoặc thay đổi các cấu hình trước khi bắt đầu OS

<img src="img/10.png">

Chọn `Begin Installation` để bắt đầu tạo máy ảo, đợi một lúc cho nó khởi động lên:

<img src="img/11.png">


<a name="virt-install"></a>
### 2. Virt-install

`virt-install` là một phần của gói `virtinst`, nên cần cài đặt gói này

	sudo apt install virtinst

Có một số tùy chọn sẵn để sử dụng virt-install. Ví dụ:

```sh
sudo virt-install -n web_devel -r 512 \
--disk path=/var/lib/libvirt/images/web_devel.img,bus=virtio,size=4 -c \
ubuntu-18.04-server-i386.iso --network network=default,model=virtio \
--graphics vnc,listen=0.0.0.0 --noautoconsole -v
```

`-n web_devel` chỉ định tên máy ảo mới là `web_devel`

`-r 512` xác định dung lượng bộ nhớ mà máy ảo sử dụng, đơn vị là megabytes.

`-disk path=/var/lib/libvirt/images/web_devel.img,size=4` cho biết đường dẫn đến đĩa ảo có thể là file, partition hoặc logical volume, ở ví dụ này là `web_devel.img` trong thư mục `/var/lib/libvirt/images/`, với kích thước là 4 gigabytes, và sử dụng virtio cho disk bus.

`-c ubuntu-18.04-server-i386.iso` file được sử dụng như một CDROM ảo. 

`--network` cung cấp chi tiết các về interface của VM. Ở đây là `default` network được sử dụng, và interface model được cấu hình cho virtio.

`--noautoconsole`: sẽ không tự động kết nối tới console của máy ảo.

`-v` tạo một máy hoàn toàn được ảo hóa.
 

<a name="webvirt"></a>
### 3. Webvirt

